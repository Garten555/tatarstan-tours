# -*- coding: utf-8 -*-
"""
Генератор ВВЕДЕНИЯ для диплома
Автор: Ахунов Данил
"""

import os
import sys

# Папка вывода
OUTPUT_DIR = r"C:\Users\Danie\OneDrive\Desktop\turrrr\diploma_output"

def create_introduction():
    """Создает файл с введением"""
    
    print("=" * 60)
    print("  ГЕНЕРАТОР ВВЕДЕНИЯ ДЛЯ ДИПЛОМА")
    print("  Автор: Ахунов Данил")
    print("=" * 60)
    print()
    
    # Создаем папку если нет
    if not os.path.exists(OUTPUT_DIR):
        os.makedirs(OUTPUT_DIR)
        print("[OK] Папка создана:", OUTPUT_DIR)
    else:
        print("[OK] Папка существует:", OUTPUT_DIR)
    print()
    
    # Текст введения
    introduction_text = """ВВЕДЕНИЕ

Современное развитие информационных технологий и стремительный рост цифровизации туристической отрасли создают принципиально новые возможности для создания инновационных платформ бронирования туров. В условиях глобализации и постоянного повышения требований к качеству сервиса автоматизация процессов организации туристической деятельности становится ключевым фактором успеха на конкурентном рынке.

Актуальность темы дипломного проекта обусловлена необходимостью создания современной, функциональной и удобной платформы для бронирования туров по Республике Татарстан. Данный регион обладает богатым культурно-историческим наследием, уникальными природными достопримечательностями и развитой туристической инфраструктурой, что делает его привлекательным направлением для внутреннего и въездного туризма.

1. Цель и задачи дипломного проекта

Целью дипломного проекта является разработка веб-приложения «Платформа туров по Татарстану» для бронирования и управления туристическими турами.

Для достижения поставленной цели были сформулированы следующие задачи:

1) провести анализ существующих аналогичных систем бронирования туров;
2) изучить современные технологии веб-разработки и выбрать оптимальный технологический стек;
3) разработать архитектуру системы с учётом требований масштабируемости и безопасности;
4) спроектировать и реализовать базу данных для хранения информации о турах, бронированиях и пользователях;
5) разработать пользовательский интерфейс для клиентской и административной частей приложения;
6) реализовать функционал системы бронирования с интеграцией платёжных систем;
7) внедрить интерактивные карты маршрутов с использованием Яндекс.Карты API;
8) реализовать чат-поддержку с AI-агентом на базе OpenRouter;
9) провести тестирование разработанного приложения.

2. Объект и предмет исследования

Объектом исследования является процесс организации и бронирования туристических туров в современных веб-приложениях.

Предметом исследования являются методы и технологии проектирования веб-приложений для туристической отрасли.

3. Методы исследования

В процессе выполнения дипломного проекта использовались следующие методы:

1) анализ научной и технической литературы;
2) изучение документации технологий и программных интерфейсов;
3) методы объектно-ориентированного проектирования;
4) методы юзабилити-тестирования;
5) методы функционального тестирования программного обеспечения.

4. Технологический стек

В рамках дипломного проекта разработано веб-приложение с использованием следующих технологий: Next.js 15.x, React 19.x, TypeScript 5.x, Tailwind CSS 3.x, Zustand 4.x, Supabase (PostgreSQL), Timeweb S3, Яндекс.Карты API, OpenRouter (AI-агент), Git.

5. Практическая значимость

Разработанная платформа обеспечивает:

1) удобный каталог туров с детальным описанием и интерактивными картами;
2) систему онлайн-бронирования с выбором способа оплаты;
3) автоматическую генерацию PDF-билетов;
4) административную панель для управления турами и бронированиями;
5) AI-чат поддержку для пользователей платформы;
6) систему ролей и прав доступа для различных категорий пользователей.

6. Структура дипломного проекта

Дипломный проект состоит из введения, четырёх глав, заключения, списка использованных источников и приложений.

Введение содержит обоснование актуальности темы, цель и задачи проекта, объект и предмет исследования, методы исследования, описание технологического стека и практическую значимость работы.

Глава 1 посвящена теоретическим основам разработки веб-приложений для туристической отрасли. Рассматриваются современные тенденции в сфере онлайн-бронирования туров, анализируются существующие аналоги, формулируются требования к разрабатываемой системе.

Глава 2 содержит описание анализа и проектирования системы. Приводится общая архитектура приложения, проектирование базы данных, описание интерфейсов пользователя и администратора.

Глава 3 описывает процесс реализации веб-приложения. Рассматриваются ключевые компоненты системы, алгоритмы работы основных функций, интеграция с внешними сервисами.

Глава 4 посвящена тестированию разработанного приложения. Описываются методы тестирования, приводятся результаты проверки функциональности и производительности системы.

Заключение содержит основные результаты дипломного проекта, выводы о достижении поставленных целей и рекомендации по дальнейшему развитию платформы."""
    
    # Сохраняем как txt файл
    txt_path = os.path.join(OUTPUT_DIR, "Введение_Ахунов.txt")
    with open(txt_path, "w", encoding="utf-8") as f:
        f.write(introduction_text)
    print("[OK] Текстовый файл создан:", txt_path)
    print()
    
    # Пытаемся создать docx через win32com (если есть Word)
    try:
        import win32com.client
        word = win32com.client.Dispatch("Word.Application")
        word.Visible = False
        
        # Создаем новый документ
        doc = word.Documents.Add()
        
        # Вставляем текст
        range_obj = doc.Range()
        range_obj.InsertBefore(introduction_text)
        
        # Форматирование по ГОСТ
        # Весь текст
        for paragraph in doc.Paragraphs:
            paragraph.Range.Font.Name = "Times New Roman"
            paragraph.Range.Font.Size = 14
            paragraph.ParagraphFormat.LineSpacing = 21  # 1.5 * 14 = 21
            paragraph.ParagraphFormat.Alignment = 3  # justify
            
            # Отступ красной строки для всех кроме заголовков
            text = paragraph.Range.Text.strip()
            if text and not any(text.startswith(str(i) + ")") for i in range(1, 10)):
                if not text.startswith("ВВЕДЕНИЕ") and not text[0].isdigit():
                    paragraph.ParagraphFormat.FirstLineIndent = Cm(1.25)
        
        # Заголовок ВВЕДЕНИЕ
        for paragraph in doc.Paragraphs:
            if "ВВЕДЕНИЕ" in paragraph.Range.Text:
                paragraph.Range.Font.Size = 16
                paragraph.ParagraphFormat.Alignment = 1  # center
                paragraph.ParagraphFormat.FirstLineIndent = 0
                break
        
        # Сохраняем
        docx_path = os.path.join(OUTPUT_DIR, "Введение_Ахунов.docx")
        doc.SaveAs(docx_path)
        doc.Close()
        word.Quit()
        
        print("[OK] Word документ создан:", docx_path)
        print()
        print("=" * 60)
        print("  ГОТОВО!")
        print("=" * 60)
        print()
        print("Файл создан:", docx_path)
        print()
        print("Инструкция:")
        print("1. Открой файл в Word")
        print("2. Проверь форматирование")
        print("3. Добавь номера страниц: Вставка -> Номер страницы -> Внизу по центру")
        print()
        
    except Exception as e:
        print("[WARN] Word не найден или ошибка:", str(e))
        print()
        print("Альтернатива:")
        print("1. Открой файл:", txt_path)
        print("2. Скопируй текст в Word")
        print("3. Настрой форматирование по ГОСТ")
        print()
        print("Параметры по ГОСТ:")
        print("- Шрифт: Times New Roman, 14 пт")
        print("- Межстрочный: 1.5")
        print("- Отступ красной строки: 1.25 см")
        print("- Поля: верх 2, низ 2, слева 2.5, справа 1.5 см")
        print()
        print("Файл создан:", txt_path)


def Cm(points):
    """Конвертация см в пункты (1 см = 28.35 пунктов)"""
    return points * 28.35


if __name__ == "__main__":
    try:
        create_introduction()
        input("\nНажми Enter для выхода...")
    except Exception as e:
        print("\n[ERROR] Ошибка:", str(e))
        input("\nНажми Enter для выхода...")
        sys.exit(1)